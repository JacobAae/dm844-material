= Groovy Introduction

[#groovy]
== Groovy?

* OO language for the JVM
* Java-like syntax
* Optional types
* Compiled
* Dynamic or Static - your choice!

[#compilation]
== Compilation

image::groovy-compiled.png[]


[source,groovy,indent=0]
.HelloWorld.groovy
----
include::../main/groovy/HelloWorld.groovy[]
----

 groovy HelloWorld.groovy

[#battle-against-verbosity]
== Battle against verbosity

* No semicolons
* Default imports
* Not all parenthesis are needed
* Not necessary with constructors
* `return` keyword is optional
* Elvis operator and other handy extensions


[#bsg]
== Examples inspired by

image::bsg.jpg[]

[#conversion-example]
== Conversion example

image::viper.jpg[]

<<<

[source,java,indent=0]
.JavaPlane.java
----
include::../main/java/dk/dm844/groovyintro/JavaPlane.java[tags=plane]
----

<<<

[source,groovy,indent=0]
.GroovyPlane.groovy
----
include::../main/groovy/dk/dm844/groovyintro/GroovyPlane.groovy[tags=plane]
----




[#other-features]
== Other features

* `==` vs `.equals()`
* Groovy truth
* Lot of extra methods for collections etc.
* Strings, and GStrings
* ... (More later)


[#optional-typing]
== Optional Typing

TIP: *Duck typing*: If it walks and talks like a duck, consider it a duck.

image::duck-typing.jpg[]

WARNING: *Duck typing* != weak typing

You can use the `def` keyword to declare an arbitrary type.

<<<

[source,groovy,indent=0]
.DuckExample.groovy
----
include::../main/groovy/dk/dm844/groovyintro/DuckExample.groovy[tags=duck]
----

[#properties]
== Properties

[source,groovy] 
----
class Battlestar {
	String name
	Integer crewsize
	Date produced
}
----

* Default everything is public
* Groovy creates getters and setters
** But you can override these, if they should have side-effects
** Not generated for private fields





[#inspecting-groovy-code]
== Inspecting Groovy Code

*AST Browser*

* Open `groovyConsole`
* Goto AST Browser (CTRL + T)

*Decompile*

* `javap yourfile.class` -> Method signatures
* `javap -c yourfile.class` -> Readable form of bytecode



[#collections]
== Collections

[TIP]
====
Lots of great extensions to the Java collection framework
====

image::bsg-collection.jpg[]

[#lists]
== Lists

[source,java,indent=0]
.Java
----
include::../main/java/dk/dm844/groovyintro/JavaCollectionSamples.java[tags=lists]
----

[source,groovy,indent=0]
.Groovy
----
include::../main/groovy/dk/dm844/groovyintro/GroovyCollectionSamples.groovy[tags=lists]
----


[#maps]
== Maps

[source,groovy,indent=0]
.Groovy
----
include::../main/groovy/dk/dm844/groovyintro/GroovyCollectionSamples.groovy[tags=maps]
----

[#range]
== Range

Ranges allow you to create a list of sequential values.

They are created with `..` and both start and end values are included

[source,groovy,indent=0]
.Groovy
----
include::../main/groovy/dk/dm844/groovyintro/GroovyCollectionSamples.groovy[tags=range]
----


[#groovy-truth]
== Groovy Truth

Standard boolean values

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth1]
----

* Empty collections -> false
* Non empty collections -> true

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth2]
----

The empty String is false, non-empty strings are true

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth3]
----

<<<

* The number 0 -> false (known from c)
* Any non-zero number -> true

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth4]
----

The `null` value is false, not null objects are true

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth5]
----

<<<

But! You can create your own boolean evaluation for objects

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/Raptor.groovy[tags=raptor]
----

[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=truth6]
----




[#constructors]
== Constructors

You typically leave out constructors in Groovy, and the compiler adds a default constructor.

You can then use named parameters, which is equivalent to calling the setters after the object is created

[source,groovy,indent=0]
.Battlestar.groovy
----
include::../main/groovy/dk/dm844/groovyintro/Battlestar.groovy[tags=battlestar]
----

This initialization
[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=constructor1]
----

is the same as
[source,groovy,indent=0]
----
include::../main/groovy/dk/dm844/groovyintro/GroovyTruth.groovy[tags=constructor2]
----



[#closures]
== Closures

* Pieces of code that can be saved as a variable
* Powerfull, fx when building DSL
* Similar to function pointers in c
* Can access nonfinal variables outside of their scope

[source,groovy]
----
TODO So far so good
def countdownRange = { int i -> i < 0 ? return  }

assert countdown.call() == '3....2....1'
assert countdown() == '3....2....1'
----

Closures can have parameters, typed or not

[source,groovy]
----
def countdown = { return '3....2....1' }

assert countdown.call() == '3....2....1'
assert countdown() == '3....2....1'
----


[#jave-not-groovy]
== When is Java not Groovy

* Initialization of arrays (Groovy uses brackets for closures)

int[] oddUnderTen = { 1, 3, 5, 7, 9 };

Use

def oddUnderTen = [1, 3, 5, 7, 9] as int[]

* New keywords: def and in

* No do/while loop in Groovy



[#groovy-gdk]
== The Groovy JDK (GDK)

Documentation at http://beta.groovy-lang.org/docs/latest/html/groovy-jdk/[]




[#special-operators]
== Special operators

=== Null-Safe Dereference

  ?.

=== Elvis

Condence ternary opertors

 ?:

=== Spread

 *.

=== Spaceship

 <=> 


== Coersion using *as*

as Set

== Shortcut for contails: *in*

assert 1 in [1, 2, 5]
assert !(3 in [1, 2, 5])


[#style-guide]
== Being 'Too Groovy'
(Styleguide)

* Work smarter, but not harder
** Take advantage of smart features, but don't overdo it (making the code hard to understand)
* Overuse of`def` keyword
** Ok on left side of assignment with clear right side
*** Clear is ot a method invocation
* for/in loop vs. each
** You can break out of the for loop
* Use closures where it is necessary, and use methods where you can
** Methods specify return type


For the official style guide: http://beta.groovy-lang.org/style-guide.html[]

Groovy Lead Guilaume Laforge have given a presentation on Groovy Style: https://skillsmatter.com/skillscasts/4957-groovy-with-style[]

[#part-2-later]
== Later we will study

* TypeChecked, CompileStatic, and invokedynamic
* Operator overloading
* Regular Expression
* Metaprogramming and MOP
* Closure magic: Owner, Delegate, this
* Method Reference



////

----------- Part two - advanced Groovy

== TypeChecked, CompileStatic, and invokedynamic

== Operator overloading


== Regular Expressions


== Metaprogramming and MOP



== Closure magic: Owner, Delegate, this

== Method Reference

The .& operator lets you get a reference to a method and treat it like a closure.


////

== Exercises

Make some of the Project Euler problems